# Qiankun 微前端错误处理解决方案

## 问题描述

在qiankun微前端项目中，当某些子应用未启动时，即使不访问相关路由也会出现"Failed to fetch"错误，影响用户体验。

## 解决方案

### 1. 禁用预加载
- 在qiankun启动配置中设置 `prefetch: false`
- 避免在应用启动时预加载所有微应用

### 2. 添加健康检查
- 在应用启动前检查各个微应用的健康状态
- 使用HEAD请求检查服务是否可访问

### 3. 错误处理机制
- 为每个微应用添加完整的生命周期钩子
- 实现全局错误处理函数
- 在微应用加载失败时显示友好的错误页面

### 4. 状态管理
- 使用全局状态管理微应用的运行状态
- 实时监控微应用状态变化
- 根据状态动态显示内容

## 主要修改文件

### `src/index.js`
- 添加微应用状态管理
- 实现健康检查功能
- 配置错误处理钩子
- 禁用预加载

### `src/App.js`
- 添加状态监听逻辑
- 实现路由级别的错误处理
- 根据微应用状态动态显示内容

### `src/components/ServiceUnavailable.js`
- 创建友好的错误提示组件
- 提供重试和返回首页功能
- 显示详细的错误信息和解决建议

## 使用方法

1. 启动基座应用：
   ```bash
   cd qiankun-base
   npm start
   ```

2. 选择性启动子应用：
   ```bash
   # 启动Vue2应用
   cd qiankun-micro-vue2-app-02
   npm run serve
   
   # 启动Vue3应用
   cd qiankun-micro-vue3-app-04
   npm run dev
   
   # React应用可以不启动
   ```

3. 访问应用：
   - 访问已启动的微应用：正常显示
   - 访问未启动的微应用：显示友好的错误提示页面

## 特性

- ✅ 禁用预加载，避免未启动服务报错
- ✅ 健康检查，提前发现服务状态
- ✅ 友好的错误提示界面
- ✅ 实时状态监控
- ✅ 重试和导航功能
- ✅ 详细的错误信息和解决建议

## 注意事项

1. 健康检查使用HEAD请求，某些服务器可能不支持
2. 状态检查间隔为2秒，可根据需要调整
3. 错误页面样式可根据项目需求自定义
4. 建议在生产环境中配置适当的超时时间

## 扩展功能

可以根据需要添加以下功能：
- 微应用状态指示器
- 自动重连机制
- 服务发现功能
- 更详细的监控面板

